(()=>{"use strict";let t=()=>JSON.parse(localStorage.getItem("watchlist"))??[],e=(e,n,s=!1)=>{const i=document.createElement("button");i.classList.add("btn"),s&&(i.classList.add("btn--100"),i.classList.add("btn--center")),i.classList.add("btn--danger");const a=document.createElement("em");a.classList.add("material-icons-outlined"),a.textContent="remove",d(i,a,e),i.addEventListener("click",(()=>{(e=>{const d=t(),n=d.findIndex((t=>t.title===e.title));n>-1?d.splice(n,1):d.push(e),(t=>{localStorage.setItem("watchlist",JSON.stringify(t))})(d)})(e),d(i,a,e),n()}));const o=document.createElement("span");return o.textContent="Watchlist",i.appendChild(a),i.appendChild(o),i},d=(e,d,n)=>{(e=>t().findIndex((t=>t.title===e.title))>-1)(n)?(d.textContent="remove",e.classList.add("btn--danger")):(d.textContent="add",e.classList.remove("btn--danger"))},n=t=>{const e=document.createElement("div");e.classList.add("movie__footer");const d=document.createElement("h3");d.classList.add("movie__title"),d.textContent=t.title;const n=document.createElement("span");n.classList.add("movie__rating");const s=t.vote_average;return s>=0&&s<3.3?n.classList.add("movie__rating--bad"):s>=3.3&&s<6.6?n.classList.add("movie__rating--okay"):s>=6.6&&s<10&&n.classList.add("movie__rating--good"),n.textContent=s.toFixed(1),e.appendChild(d),e.appendChild(n),e},s=()=>{fetch("https://api.themoviedb.org/3/movie/popular?api_key=0f2fb5bb9dd4392d617cd67097866357").then((t=>t.json())).then((t=>t.results)).then((t=>{const d=document.getElementById("popular-movies");t.forEach((t=>((t,d)=>{const s=document.createElement("article");s.classList.add("movie");const i=document.createElement("img");i.classList.add("movie__poster"),i.src=`https://image.tmdb.org/t/p/w500${t.poster_path}`;const a=n(t),o=(t=>{const d=document.createElement("div");d.classList.add("movie__details");const s=n(t),i=document.createElement("p");i.classList.add("movie__description"),i.textContent=t.overview;const a=document.createElement("div");a.classList.add("movie__actions");const o=e(t,(()=>{}),!0);return a.appendChild(o),d.appendChild(s),d.appendChild(i),d.appendChild(a),d})(t);s.appendChild(i),s.appendChild(a),s.appendChild(o),d.appendChild(s)})(t,d)))}))},i=()=>{const d=document.getElementById("watchlist"),n=t();n.forEach((t=>{((t,d)=>{const n=document.createElement("li");n.id=`movie-${t.id}`,n.classList.add("list__item"),n.setAttribute("data-movie-id",t.id);const s=document.createElement("h3");s.classList.add("list__title"),s.textContent=t.title;const i=e(t,(()=>{((t,e)=>{const d=document.querySelectorAll(`[data-movie-id="${t.id}"]`);e.removeChild(d[0])})(t,d)}));n.appendChild(s),n.appendChild(i),d.appendChild(n)})(t,d)})),a(d,n)},a=(t,e)=>{document.getElementById("watchlist-filter").addEventListener("keyup",(d=>{const n=d.target.value.toLowerCase(),s=e.filter((t=>t.title.toLowerCase().includes(n))).map((t=>`movie-${t.id}`)),i=t.children;for(let t of i)s.includes(t.id)?t.classList.remove("list__item--hide"):t.classList.add("list__item--hide")}))};const o={"page-index":()=>{s()},"page-watchlist":()=>{i()}},c=()=>{const t=document.body.id;o[t]()};(()=>{(()=>{const t=document.querySelector("main"),e=document.querySelector("nav");t.addEventListener("scroll",(()=>{((t,e)=>{t.scrollTop>75?e.classList.add("nav--on-scroll"):e.classList.remove("nav--on-scroll")})(t,e)}))})()})(),c()})();