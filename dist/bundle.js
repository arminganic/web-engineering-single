(()=>{"use strict";let t=()=>JSON.parse(localStorage.getItem("watchlist"))??[],e=(e,s,d=!1)=>{const a=document.createElement("button");a.classList.add("btn"),d&&(a.classList.add("btn--100"),a.classList.add("btn--center")),a.classList.add("btn--danger");const o=document.createElement("em");o.classList.add("material-icons-outlined"),o.textContent="remove",n(a,o,e),a.addEventListener("click",(()=>{(e=>{const n=t(),s=n.findIndex((t=>t.title===e.title));s>-1?n.splice(s,1):n.push(e),(t=>{localStorage.setItem("watchlist",JSON.stringify(t))})(n)})(e),n(a,o,e),s()}));const i=document.createElement("span");return i.textContent="Watchlist",a.appendChild(o),a.appendChild(i),a},n=(e,n,s)=>{(e=>t().findIndex((t=>t.title===e.title))>-1)(s)?(n.textContent="remove",e.classList.add("btn--danger")):(n.textContent="add",e.classList.remove("btn--danger"))},s=t=>{const e=document.createElement("div");e.classList.add("movie__footer");const n=document.createElement("h3");n.classList.add("movie__title"),n.textContent=t.title;const s=document.createElement("span");s.classList.add("movie__rating");const d=t.vote_average;return d>=0&&d<3.3?s.classList.add("movie__rating--bad"):d>=3.3&&d<6.6?s.classList.add("movie__rating--okay"):d>=6.6&&d<10&&s.classList.add("movie__rating--good"),s.textContent=d.toFixed(1),e.appendChild(n),e.appendChild(s),e},d=()=>{fetch("https://api.themoviedb.org/3/movie/popular?api_key=0f2fb5bb9dd4392d617cd67097866357").then((t=>t.json())).then((t=>t.results)).then((t=>{const n=document.getElementById("popular-movies");t.forEach((t=>((t,n)=>{const d=document.createElement("article");d.classList.add("movie");const a=document.createElement("img");a.classList.add("movie__poster"),a.src=`https://image.tmdb.org/t/p/w500${t.poster_path}`;const o=s(t),i=(t=>{const n=document.createElement("div");n.classList.add("movie__details");const d=s(t),a=document.createElement("p");a.classList.add("movie__description"),a.textContent=t.overview;const o=document.createElement("div");o.classList.add("movie__actions");const i=e(t,(()=>{}),!0);return o.appendChild(i),n.appendChild(d),n.appendChild(a),n.appendChild(o),n})(t);d.appendChild(a),d.appendChild(o),d.appendChild(i),n.appendChild(d)})(t,n)))}))},a=()=>{console.log("Init Watchlist");const n=document.getElementById("watchlist");t().forEach((t=>{((t,n)=>{const s=document.createElement("li");s.classList.add("list__item"),s.setAttribute("data-movie-id",t.id);const d=document.createElement("h3");d.classList.add("list__title"),d.textContent=t.title;const a=e(t,(()=>{((t,e)=>{const n=document.querySelectorAll(`[data-movie-id="${t.id}"]`);console.log(typeof n),console.log(n),e.removeChild(n[0])})(t,n)}));s.appendChild(d),s.appendChild(a),n.appendChild(s)})(t,n)}))};const o={"page-index":()=>{d()},"page-watchlist":()=>{a()}},i=()=>{const t=document.body.id;o[t]()};(()=>{(()=>{const t=document.querySelector("main"),e=document.querySelector("nav");t.addEventListener("scroll",(()=>{((t,e)=>{t.scrollTop>75?e.classList.add("nav--on-scroll"):e.classList.remove("nav--on-scroll")})(t,e)}))})()})(),i()})();